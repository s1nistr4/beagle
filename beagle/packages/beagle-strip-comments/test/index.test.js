"use strict";var fs=require("fs"),assert=require("assert"),lineJSON=require("line-json"),strip=require("../"),dir=__dirname+"/cases/";fs.readdirSync(dir).forEach(function(a){/\.input\.json$/.test(a)&&test(a,function(){function b(b,c){var d=fs.readFileSync(dir+a,"utf8");d=lineJSON.parse(d);var e=strip(d,c);expect(e).toMatchSnapshot()}a.replace(/\.input\.json$/,".");b("unbuffered"),b("buffered",{stripBuffered:!0,stripUnbuffered:!1}),b("both",{stripBuffered:!0})})});var edir=__dirname+"/errors/";fs.readdirSync(edir).forEach(function(a){/\.input\.json$/.test(a)&&test(a,function(){var b=a.replace(/\.input\.json$/,"."),c=fs.readFileSync(edir+a,"utf8");c=lineJSON.parse(c);try{throw strip(c),new Error("Expected "+a+" to throw an exception.")}catch(a){if(!a||!a.code||0!==a.code.indexOf("PUG:"))throw a;expect({msg:a.msg,code:a.code,line:a.line}).toMatchSnapshot()}})});