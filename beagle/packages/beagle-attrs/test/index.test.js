"use strict";var options,assert=require("assert"),utils=require("util"),attrs=require("../");function test(a,b,c){var d=options;c=c||{},c.pug=c.pug||require("beagle-runtime"),it(utils.inspect(a).replace(/\n/g,"")+" => "+utils.inspect(b),function(){var e=attrs(a,d),f=Object.keys(c).sort(),g=Function(f.join(", "),"return ("+e+");").apply(null,f.map(function(a){return c[a]}));"html"===d.format?expect(g).toBe(b):expect(g).toEqual(b)})}function withOptions(a,b){describe("options: "+utils.inspect(a),function(){options=a,b()})}withOptions({terse:!0,format:"html",runtime:function(a){return"pug."+a}},function(){test([],""),test([{name:"foo",val:"false",mustEscape:!0}],""),test([{name:"foo",val:"true",mustEscape:!0}]," foo"),test([{name:"foo",val:!1,mustEscape:!0}],""),test([{name:"foo",val:!0,mustEscape:!0}]," foo"),test([{name:"foo",val:"foo",mustEscape:!0}],"",{foo:!1}),test([{name:"foo",val:"foo",mustEscape:!0}]," foo",{foo:!0}),test([{name:"foo",val:"\"foo\"",mustEscape:!0}]," foo=\"foo\""),test([{name:"foo",val:"\"foo\"",mustEscape:!0},{name:"bar",val:"\"bar\"",mustEscape:!0}]," foo=\"foo\" bar=\"bar\""),test([{name:"foo",val:"foo",mustEscape:!0}]," foo=\"fooo\"",{foo:"fooo"}),test([{name:"foo",val:"foo",mustEscape:!0},{name:"bar",val:"bar",mustEscape:!0}]," foo=\"fooo\" bar=\"baro\"",{foo:"fooo",bar:"baro"}),test([{name:"style",val:"{color: \"red\"}",mustEscape:!0}]," style=\"color:red;\""),test([{name:"style",val:"{color: color}",mustEscape:!0}]," style=\"color:red;\"",{color:"red"}),test([{name:"class",val:"\"foo\"",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}]," class=\"foo bar baz\""),test([{name:"class",val:"{foo: foo}",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}]," class=\"foo bar baz\"",{foo:!0}),test([{name:"class",val:"{foo: foo}",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}]," class=\"bar baz\"",{foo:!1}),test([{name:"class",val:"foo",mustEscape:!0},{name:"class",val:"\"<str>\"",mustEscape:!0}]," class=\"&lt;foo&gt; &lt;str&gt;\"",{foo:"<foo>"}),test([{name:"foo",val:"\"foo\"",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}]," class=\"bar baz\" foo=\"foo\""),test([{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0},{name:"foo",val:"\"foo\"",mustEscape:!0}]," class=\"bar baz\" foo=\"foo\""),test([{name:"foo",val:"\"<foo>\"",mustEscape:!1}]," foo=\"<foo>\""),test([{name:"foo",val:"\"<foo>\"",mustEscape:!0}]," foo=\"&lt;foo&gt;\""),test([{name:"foo",val:"foo",mustEscape:!1}]," foo=\"<foo>\"",{foo:"<foo>"}),test([{name:"foo",val:"foo",mustEscape:!0}]," foo=\"&lt;foo&gt;\"",{foo:"<foo>"})}),withOptions({terse:!1,format:"html",runtime:function(a){return"pug."+a}},function(){test([{name:"foo",val:"false",mustEscape:!0}],""),test([{name:"foo",val:"true",mustEscape:!0}]," foo=\"foo\""),test([{name:"foo",val:!1,mustEscape:!0}],""),test([{name:"foo",val:!0,mustEscape:!0}]," foo=\"foo\""),test([{name:"foo",val:"foo",mustEscape:!0}],"",{foo:!1}),test([{name:"foo",val:"foo",mustEscape:!0}]," foo=\"foo\"",{foo:!0})}),withOptions({terse:!0,format:"object",runtime:function(a){return"pug."+a}},function(){test([],{}),test([{name:"foo",val:"false",mustEscape:!0}],{foo:!1}),test([{name:"foo",val:"true",mustEscape:!0}],{foo:!0}),test([{name:"foo",val:!1,mustEscape:!0}],{foo:!1}),test([{name:"foo",val:!0,mustEscape:!0}],{foo:!0}),test([{name:"foo",val:"foo",mustEscape:!0}],{foo:!1},{foo:!1}),test([{name:"foo",val:"foo",mustEscape:!0}],{foo:!0},{foo:!0}),test([{name:"foo",val:"\"foo\"",mustEscape:!0}],{foo:"foo"}),test([{name:"foo",val:"\"foo\"",mustEscape:!0},{name:"bar",val:"\"bar\"",mustEscape:!0}],{foo:"foo",bar:"bar"}),test([{name:"foo",val:"foo",mustEscape:!0}],{foo:"fooo"},{foo:"fooo"}),test([{name:"foo",val:"foo",mustEscape:!0},{name:"bar",val:"bar",mustEscape:!0}],{foo:"fooo",bar:"baro"},{foo:"fooo",bar:"baro"}),test([{name:"style",val:"{color: \"red\"}",mustEscape:!0}],{style:"color:red;"}),test([{name:"style",val:"{color: color}",mustEscape:!0}],{style:"color:red;"},{color:"red"}),test([{name:"class",val:"\"foo\"",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}],{class:"foo bar baz"}),test([{name:"class",val:"{foo: foo}",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}],{class:"foo bar baz"},{foo:!0}),test([{name:"class",val:"{foo: foo}",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}],{class:"bar baz"},{foo:!1}),test([{name:"class",val:"foo",mustEscape:!0},{name:"class",val:"\"<str>\"",mustEscape:!0}],{class:"&lt;foo&gt; &lt;str&gt;"},{foo:"<foo>"}),test([{name:"foo",val:"\"foo\"",mustEscape:!0},{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0}],{class:"bar baz",foo:"foo"}),test([{name:"class",val:"[\"bar\", \"baz\"]",mustEscape:!0},{name:"foo",val:"\"foo\"",mustEscape:!0}],{class:"bar baz",foo:"foo"}),test([{name:"foo",val:"\"<foo>\"",mustEscape:!1}],{foo:"<foo>"}),test([{name:"foo",val:"\"<foo>\"",mustEscape:!0}],{foo:"&lt;foo&gt;"}),test([{name:"foo",val:"foo",mustEscape:!1}],{foo:"<foo>"},{foo:"<foo>"}),test([{name:"foo",val:"foo",mustEscape:!0}],{foo:"&lt;foo&gt;"},{foo:"<foo>"})}),withOptions({terse:!1,format:"object",runtime:function(a){return"pug."+a}},function(){test([{name:"foo",val:"false",mustEscape:!0}],{foo:!1}),test([{name:"foo",val:"true",mustEscape:!0}],{foo:!0}),test([{name:"foo",val:!1,mustEscape:!0}],{foo:!1}),test([{name:"foo",val:!0,mustEscape:!0}],{foo:!0}),test([{name:"foo",val:"foo",mustEscape:!0}],{foo:!1},{foo:!1}),test([{name:"foo",val:"foo",mustEscape:!0}],{foo:!0},{foo:!0})});